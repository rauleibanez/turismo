<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ negocio.nombre }} - El Carmen Travel</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <link rel="stylesheet" href="../static/css/style.css">
    </head>
<body>
    <header class="header">
    <div class="logo">
      <a href="/">
        <img src="https://live.staticflickr.com/65535/54784942459_f2bcffbbfb_b.jpg" alt="Logo de El Carmen Travel">
      </a>
    </div>
    <nav class="nav-menu">
        </nav>
    <div class="back-link">
            <a href="/" class="btn-back">
                <i class="fas fa-arrow-left"></i> Volver al Inicio
            </a>
        </div>        
    </header>

    <main class="business-detail">
        
        <div class="detail-main-content">
        <div class="business-info-panel">
            <img src={{ negocio.imagen_url }} 
                 alt="Imagen de {{ negocio.nombre }}" 
                 class="detail-small-image"> <div class="detail-text-info">
                <h1>{{ negocio.nombre }}</h1>
                <p class="detail-category">{{ negocio.categoria }}</p>
                <div class="rating">
                    <span>Ranking: {{ negocio.promedio_ranking }}</span>
                    <div class="rating-display-thumbs">
                        <span class="rating-percentage">{{ "%.0f"|format(negocio.promedio_ranking * 20) }}%</span>
                        
                        <div class="thumb-icons">
                            {% if negocio.promedio_ranking >= 3.5 %}
                                <i class="fas fa-thumbs-up thumbs-up"></i>
                            {% else %}
                                <i class="fas fa-thumbs-down thumbs-down"></i>
                            {% endif %}
                        </div>
                    </div>
                </div>
                <h3>Descripción</h3>
                <p>{{ negocio.descripcion }}</p>
                
               <h3>Horario de Atención</h3>
        <ul class="business-hours">
            {% for dia, horario in negocio.horario_atencion.items() %}
                <li>
                    <span class="day">{{ dia | capitalize }}:</span>
                    <span class="hours">{{ horario }}</span>
                </li>
            {% endfor %}
        </ul>

        <h3>Contacto</h3>
            <ul>
               <li>Teléfono: {{ negocio.telefono }}</li>
               <li>Email: {{ negocio.email }}</li>
            </ul>
            </div>
        </div>

        <div class="business-map-panel">
            <h3>Ubicación</h3>
            <p>{{ negocio.direccion }}</p>
            <div id="business-map" class="business-map"></div>
        </div>
    </div>
    </main>

    <footer class="footer">
    </footer>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
    // Obtiene las coordenadas del negocio que pasaste desde Flask
    const lat = "{{ negocio.coordenadas.lat }}";
    const lng = "{{ negocio.coordenadas.lon }}";
    const negocioNombre = "{{ negocio.nombre }}";

    if (lat && lng) {
        // Inicializa el mapa centrado en las coordenadas del negocio
        const map = L.map('business-map').setView([lat, lng], 16);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Agrega un marcador en la ubicación del negocio
        L.marker([lat, lng]).addTo(map)
            .bindPopup(`<b>${negocioNombre}</b>`).openPopup();
    }
</script>
</body>
</html>